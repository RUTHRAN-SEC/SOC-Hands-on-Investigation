# Follina (CVE-2022-30190) – Active RCE Exploitation Analysis

## **Follina**

## Blue Team Lab Online

### Tools Used: VirusTotal, Hybrid Analysis/ Anyrun SandBox, OSINT (Google)

## Incident Response

### Scenario

On a Friday evening, the SOC received an alert regarding a **newly disclosed Remote Code Execution (RCE) vulnerability** actively exploited in the wild, identified as **Follina (CVE-2022-30190)**. The vulnerability allows attackers to execute arbitrary code via malicious Microsoft Office documents abusing the **MSDT protocol**.

You were tasked with analyzing the malicious sample and understand attacker behavior, and document findings for the weekend response team.

## Alert: **Critical Remote Code Execution Vulnerability Actively Exploited in the Wild**

We got a file Name: 43eecf22e8f914d44df3da16c23dcc2e076a8753.zip

After extracted: sample/sample.doc → Microsoft Word

Using a Kali linux VM for the investigation 

### Challenge Question

1.What is the SHA1 hash value of the sample? (Format: SHA1Hash)

To get the file hash we have to use the built-in tool sha1sum <filename>

<img width="501" height="166" alt="Screenshot 2026-01-18 145944" src="https://github.com/user-attachments/assets/79da94e4-1238-400d-9b8a-14fd55209613" />

Answer: 06727ffda60359236a8029e0b3e8a0fd11c23313

2.According to VirusTotal, what is the full filetype of the provided sample? (Format: X X X X) 

To know the full file type we are using VirusTotal platform. In the Details field we see a file type 

<img width="959" height="472" alt="Screenshot 2026-01-18 150303" src="https://github.com/user-attachments/assets/43f083d9-f934-4863-9698-fee0ff412049" />

Answer: Office Open XML Document 

3.Extract the URL that is used within the sample and submit it (Format: https://x.domain.tld/path/to/something) 

Tried these URLs but 5th one was the correct 

<img width="960" height="465" alt="Screenshot 2026-01-18 151658" src="https://github.com/user-attachments/assets/9bdfea65-e6a9-49b2-9d8d-9b12db86878d" />

Answer:hxxps[://]www[.]xmlformats[.]com/office/word/2022/wordprocessingDrawing/RDF842l[.]html → defang the URL

4.What is the name of the XML file that is storing the extracted URL? (Format: file.name.ext) 

I have unzip the sample.doc file. After learning that Microsoft doc have a zip files and folders. In that one with .rels extension was suspicious also contains the same format style that mentioned in the question 

<img width="411" height="245" alt="Screenshot 2026-01-18 184851" src="https://github.com/user-attachments/assets/878234a9-3dad-44d1-b783-fff72fbae5f9" />

Answer: document.xml.rels

5.The extracted URL accesses a HTML file that triggers the vulnerability to execute a malicious payload. According to the HTML processing functions, any files with fewer than <Number> bytes would not invoke the payload. Submit the <Number> (Format: Number of Bytes) 

To see the size of all the files and folders i used [ ls -l * ] command. In that the folder _rels and theme folder alone contains same byte size which is 4096 KB , Where i also confirmed with google.  

<img width="528" height="364" alt="Screenshot 2026-01-18 190213" src="https://github.com/user-attachments/assets/8492bfbc-3e7d-4567-a573-b5c4ab3e415a" />

The Google results

<img width="560" height="261" alt="Screenshot 2026-01-18 190527" src="https://github.com/user-attachments/assets/f9cabb4c-6743-480e-8e4d-7709ef2b1fd7" />

Answer: 4096

6.After execution, the sample will try to kill a process if it is already running. What is the name of this process? (Format: filename.ext) 

We have to search through google it states that whenever the exploit in script tags in html malicious file is executed one of the first things it do is kill msdt.exe process

<img width="690" height="314" alt="Screenshot 2026-01-18 193004" src="https://github.com/user-attachments/assets/98337410-8180-49a8-a307-afef6d4a3c81" />

Answer: msdt.exe

7.You were asked to write a process-based detection rule using Windows Event ID 4688. What would be the ProcessName and ParentProcessname used in this detection rule? (Format: ProcessName, ParentProcessName)

Just search in google what is the process and parent process name 

<img width="683" height="461" alt="Screenshot 2026-01-18 193624" src="https://github.com/user-attachments/assets/d09ab74e-647d-4c94-be4e-de09a6e56de2" />

Answer: msdt.exe, winword.exe

8.Submit the MITRE technique ID used by the sample for Execution (Format: TXXXX) 

I Used Hybrid Analysis Sandbox cause i am familiar with it. Search MITRE in that look for the execution field. In the Name field i saw the JavaScript cause the malware has html extension 

<img width="960" height="316" alt="Screenshot 2026-01-18 194505" src="https://github.com/user-attachments/assets/d73be85e-838a-4768-914c-2d0fb50ad0fe" />

Answer: T1059

9.Question 9) Submit the CVE associated with the vulnerability that is being exploited (Format: CVE-XXXX-XXXXX) 

In the hybird Analysis search for the cve to find it 

<img width="958" height="345" alt="Screenshot 2026-01-18 194729" src="https://github.com/user-attachments/assets/d2d83fd3-875d-4e64-9d09-37925b2bdcbe" />

Answer:  CVE-2022-30190

## Done By RUTHRAN-SEC
